/**
 * Created by jahv on 2017/5/6.
 */
import webpack from "webpack";
import WebpackDevServer from "webpack-dev-server";
import express from "express";
import proxy from "proxy-middleware";
import webpack_config from "../webpack.config";
import url from "url";

const server = express();
server.use('/assets', proxy(url.parse(`http://127.0.0.1:3001/assets`)));
new WebpackDevServer(webpack(webpack_config), {
    contentBase: __dirname,
    hot: true,
    quiet: false,
    noInfo: false,
    publicPath: '/assets/',
    stats: {
        colors: true,
        reasons: false,
        hash: false,
        version: false,
        timings: true,
        chunks: false,
        chunkModules: false,
        cached: false,
        cachedAssets: false
    }
}).listen(3001, 'localhost', function () {
    console.log(`Webpack dev server run as 3001`)
});

server.get("*", function (req, res) {
    res.sendFile(__dirname+"/index.html");
});

server.listen(3000);